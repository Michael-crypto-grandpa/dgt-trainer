<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>DGT iPhone Trainer</title>
  <meta name="description" content="–ü—Ä–æ—Å—Ç–æ–µ –æ—Ñ–ª–∞–π–Ω‚Äë—Ç—Ä–µ–Ω–∞–∂—ë—Ä —Ç–µ—Å—Ç–æ–≤ –¥–ª—è —ç–∫–∑–∞–º–µ–Ω–∞ –Ω–∞ –≤–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–µ –ø—Ä–∞–≤–∞ (ES). –ò–º–ø–æ—Ä—Ç/—ç–∫—Å–ø–æ—Ä—Ç –≤–æ–ø—Ä–æ—Å–æ–≤ –≤ JSON, —Ä–µ–∂–∏–º –ø—Ä–∞–∫—Ç–∏–∫–∏ –∏ —ç–∫–∑–∞–º–µ–Ω–∞, –ª–æ–∫–∞–ª—å–Ω–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞." />
  
  <style>
    :root{
      --bg:#0b0f14; --panel:#121821; --card:#18202b; --ink:#e7eef7; --muted:#a9b7c8; --acc:#5bd4ff; --good:#1ec28b; --bad:#ff6b6b; --warn:#ffc857;
    }
    *{box-sizing:border-box}
    html,body{margin:0; height:100%; font-family: -apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Inter,Helvetica,Arial,system-ui,Apple Color Emoji,Segoe UI Emoji; background:var(--bg); color:var(--ink)}
    .wrap{max-width:900px; margin:0 auto; padding: max(12px, env(safe-area-inset-top)) 12px calc(12px + env(safe-area-inset-bottom));}
    header{position:sticky; top:0; z-index:20; background:linear-gradient(180deg, rgba(11,15,20,.98) 80%, rgba(11,15,20,0)); backdrop-filter:saturate(1.2) blur(8px); padding:8px 4px 6px; border-bottom:1px solid rgba(255,255,255,.05)}
    h1{font-size:20px; margin:0; letter-spacing:.2px}
    .subtitle{color:var(--muted); font-size:12px; margin-top:2px}
    .row{display:flex; gap:8px; flex-wrap:wrap; align-items:center}
    .grow{flex:1}
    .card{background:var(--card); border:1px solid rgba(255,255,255,.05); border-radius:16px; padding:14px}
    .controls{display:flex; gap:8px; flex-wrap:wrap; align-items:center}
    .btn{background:#10161f; border:1px solid rgba(255,255,255,.08); color:var(--ink); padding:12px 14px; border-radius:12px; font-weight:600; cursor:pointer; touch-action:manipulation}
    .btn:hover{border-color: rgba(255,255,255,.18)}
    .btn.primary{background:linear-gradient(180deg,#1a5cff,#147aff); border-color:rgba(255,255,255,.2)}
    .btn.good{background:linear-gradient(180deg,#0dab77,#0c9b6c)}
    .btn.bad{background:linear-gradient(180deg,#e15555,#d24040)}
    .btn.ghost{background:transparent}
    .btn.small{padding:8px 10px; font-weight:500}
    .seg{display:flex; gap:6px; background:rgba(255,255,255,.04); padding:4px; border-radius:12px; border:1px solid rgba(255,255,255,.06)}
    .seg button{flex:1; padding:8px 10px; border-radius:10px; background:transparent; color:var(--ink); border:none; font-weight:600}
    .seg button.active{background:var(--acc); color:#00131f}
    .qarea{display:grid; gap:10px}
    .qtxt{font-size:18px; line-height:1.35}
    .choices{display:grid; gap:8px}
    .choice{display:flex; gap:10px; align-items:flex-start; background:rgba(255,255,255,.03); border:1px solid rgba(255,255,255,.07); padding:10px 12px; border-radius:12px; cursor:pointer}
    .choice input{margin-top:4px}
    .choice.correct{outline:2px solid var(--good)}
    .choice.incorrect{outline:2px solid var(--bad)}
    .explain{background:rgba(27,205,255,.08); border:1px dashed rgba(91,212,255,.45); padding:10px 12px; border-radius:12px; color:#d9f6ff}
    .muted{color:var(--muted)}
    .bar{height:8px; background:rgba(255,255,255,.06); border-radius:999px; overflow:hidden}
    .bar > span{display:block; height:100%; background:linear-gradient(90deg,#5bd4ff,#1ec28b)}
    .grid{display:grid; gap:10px}
    .two{grid-template-columns:1fr}
    @media (min-width:740px){.two{grid-template-columns:1fr 1fr}}
    .hidden{display:none !important}
    .right{color:var(--good)}
    .wrong{color:var(--bad)}
    .image{width:100%; border-radius:12px; border:1px solid rgba(255,255,255,.06)}
    label.file{display:inline-flex; align-items:center; gap:8px; cursor:pointer}
    input[type="file"]{display:none}
    input[type="text"], select{background:#0f141c; color:var(--ink); border:1px solid rgba(255,255,255,.1); border-radius:10px; padding:10px 12px; width:100%}
  </style>
</head>
<body>
  <header>
    <div class="wrap">
      <div class="row" style="justify-content:space-between; align-items:flex-start; gap:12px">
        <div>
          <h1>üìò DGT iPhone Trainer</h1>
          <div class="subtitle">–¢—Ä–µ–Ω–∏—Ä—É–π—Ç–µ—Å—å –∫ —Ç–µ–æ—Ä–∏–∏ (ES). –†–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ iPhone, –æ—Ñ–ª–∞–π–Ω‚Äë–ø—Ä–æ–≥—Ä–µ—Å—Å —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ.</div>
        </div>
        <div class="row">
          <div class="seg" role="tablist" aria-label="mode">
            <button id="modePractice" class="active" aria-selected="true">–ü—Ä–∞–∫—Ç–∏–∫–∞</button>
            <button id="modeExam" aria-selected="false">–≠–∫–∑–∞–º–µ–Ω</button>
          </div>
          <button id="btnSettings" class="btn small">‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏</button>
        </div>
      </div>
    </div>
  </header>

  <main class="wrap" style="display:grid; gap:12px">

    <section id="settingsPanel" class="card hidden" aria-live="polite">
      <div class="grid two">
        <div class="card" style="background:#111723">
          <h3 style="margin:0 0 10px">–ü—Ä–æ—Ñ–∏–ª—å –∏ —è–∑—ã–∫</h3>
          <div class="grid" style="gap:8px">
            <label>–ò–º—è –ø—Ä–æ—Ñ–∏–ª—è (–¥–ª—è —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞)
              <input type="text" id="profileName" placeholder="–ù–∞–ø—Ä.: Michael –∏–ª–∏ Masha" />
            </label>
            <label>–Ø–∑—ã–∫ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
              <select id="uiLang">
                <option value="ru">–†—É—Å—Å–∫–∏–π</option>
                <option value="es">Espa√±ol</option>
              </select>
            </label>
            <div class="muted">–°–æ–≤–µ—Ç: –≤—ã —Å —Å—É–ø—Ä—É–≥–æ–π –º–æ–∂–µ—Ç–µ —É–∫–∞–∑–∞—Ç—å —Ä–∞–∑–Ω—ã–µ –∏–º–µ–Ω–∞ –ø—Ä–æ—Ñ–∏–ª—è ‚Äî —É –∫–∞–∂–¥–æ–≥–æ –±—É–¥–µ—Ç —Å–≤–æ–π –ø—Ä–æ–≥—Ä–µ—Å—Å.</div>
          </div>
        </div>
        <div class="card" style="background:#111723">
          <h3 style="margin:0 0 10px">–ò–º–ø–æ—Ä—Ç/—ç–∫—Å–ø–æ—Ä—Ç</h3>
          <div class="grid" style="gap:8px">
            <div class="row">
              <label class="file btn small">üì• –ò–º–ø–æ—Ä—Ç –≤–æ–ø—Ä–æ—Å–æ–≤ (JSON)
                <input type="file" id="importFile" accept="application/json" />
              </label>
              <button id="btnExport" class="btn small">üì§ –≠–∫—Å–ø–æ—Ä—Ç (–≤–æ–ø—Ä–æ—Å—ã+–ø—Ä–æ–≥—Ä–µ—Å—Å)</button>
            </div>
            <button id="btnReset" class="btn small bad">‚ôªÔ∏è –°–±—Ä–æ—Å–∏—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å</button>
            <details>
              <summary>üìÑ –§–æ—Ä–º–∞—Ç JSON (–ø—Ä–∏–º–µ—Ä)</summary>
<pre style="white-space:pre-wrap; font-size:12px; color:#cfe8ff; background:#0c121a; padding:8px; border-radius:10px; border:1px solid rgba(255,255,255,.08)">[
  {
    "id": 1,
    "topic": "–ó–Ω–∞–∫–∏",
    "image": null,
    "question": {"ru": "–ß—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç –∫—Ä–∞—Å–Ω—ã–π –≤–æ—Å—å–º–∏—É–≥–æ–ª—å–Ω—ã–π –∑–Ω–∞–∫?", "es": "¬øQu√© significa la se√±al octogonal roja?"},
    "choices": [
      {"id":"A","text":{"ru":"–£—Å—Ç—É–ø–∏ –¥–æ—Ä–æ–≥—É","es":"Ceda el paso"}},
      {"id":"B","text":{"ru":"–°—Ç–æ–ø","es":"Stop"}},
      {"id":"C","text":{"ru":"–ó–∞–ø—Ä–µ—Ç –æ–±–≥–æ–Ω–∞","es":"Prohibido adelantar"}}
    ],
    "correct": ["B"],
    "explanation": {"ru": "–ö—Ä–∞—Å–Ω—ã–π –≤–æ—Å—å–º–∏—É–≥–æ–ª—å–Ω–∏–∫ ‚Äî –≤—Å–µ–≥–¥–∞ STOP.", "es": "La se√±al octogonal roja significa STOP."}
  }
]</pre>
            </details>
          </div>
        </div>
      </div>
      <div class="row" style="justify-content:flex-end"><button id="btnCloseSettings" class="btn">–ì–æ—Ç–æ–≤–æ</button></div>
    </section>

    <section class="card">
      <div class="row" style="align-items:center; gap:10px">
        <div class="grow">
          <div class="bar" aria-label="–ü—Ä–æ–≥—Ä–µ—Å—Å"><span id="progressBar" style="width:0%"></span></div>
          <div class="muted" id="progressText" style="margin-top:6px">0 / 0</div>
        </div>
        <div class="row">
          <button id="btnPrev" class="btn small">‚óÄÔ∏é –ù–∞–∑–∞–¥</button>
          <button id="btnNext" class="btn small">–í–ø–µ—Ä—ë–¥ ‚ñ∂Ô∏é</button>
        </div>
      </div>
    </section>

    <section id="qa" class="card qarea" aria-live="polite">
      <div id="topic" class="muted"></div>
      <img id="qImage" class="image hidden" alt="–ò–ª–ª—é—Å—Ç—Ä–∞—Ü–∏—è –∫ –≤–æ–ø—Ä–æ—Å—É" />
      <div id="qText" class="qtxt"></div>
      <div id="choices" class="choices"></div>
      <div id="explain" class="explain hidden"></div>
      <div class="row">
        <button id="btnCheck" class="btn primary">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å</button>
        <button id="btnReveal" class="btn ghost">–ü–æ–∫–∞–∑–∞—Ç—å –æ—Ç–≤–µ—Ç</button>
        <button id="btnMarkHard" class="btn ghost">‚òÖ –°–ª–æ–∂–Ω—ã–π</button>
      </div>
    </section>

    <section id="examPanel" class="card hidden">
      <div class="grid two">
        <div class="card" style="background:#111723">
          <h3 style="margin:0 0 10px">–ù–∞—Å—Ç—Ä–æ–π–∫–∞ —ç–∫–∑–∞–º–µ–Ω–∞</h3>
          <label>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–æ–ø—Ä–æ—Å–æ–≤
            <input type="text" id="examCount" inputmode="numeric" value="30" />
          </label>
          <label>–ü–µ—Ä–µ–º–µ—à–∏–≤–∞—Ç—å –ø–æ—Ä—è–¥–æ–∫
            <select id="examShuffle"><option value="1">–î–∞</option><option value="0">–ù–µ—Ç</option></select>
          </label>
          <button id="btnStartExam" class="btn">–ù–∞—á–∞—Ç—å —ç–∫–∑–∞–º–µ–Ω</button>
        </div>
        <div class="card" style="background:#111723">
          <h3 style="margin:0 0 10px">–†–µ–∑—É–ª—å—Ç–∞—Ç—ã</h3>
          <div id="examStats" class="muted">–ü–æ–∫–∞ –Ω–µ—Ç –ø–æ–ø—ã—Ç–æ–∫.</div>
          <div id="examReview" class="grid" style="gap:6px"></div>
        </div>
      </div>
    </section>

    <footer class="muted" style="text-align:center; padding:18px 0 8px">
      <div>–î–æ–±–∞–≤–∏—Ç—å –Ω–∞ —ç–∫—Ä–∞–Ω iPhone: –≤ Safari –Ω–∞–∂–º–∏—Ç–µ <strong>–ü–æ–¥–µ–ª–∏—Ç—å—Å—è ‚Üí –ù–∞ —ç–∫—Ä–∞–Ω ¬´–î–æ–º–æ–π¬ª</strong>.</div>
      <div style="margin-top:6px">–î–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ. –≠—Ç–æ —É—á–µ–±–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –∏ –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã—Ö –±–∏–ª–µ—Ç–æ–≤ DGT.</div>
    </footer>

  </main>

  <script>
  // -------------------- i18n helpers --------------------
  const i18n = {
    ru: {
      practice: '–ü—Ä–∞–∫—Ç–∏–∫–∞', exam: '–≠–∫–∑–∞–º–µ–Ω', settings: '–ù–∞—Å—Ç—Ä–æ–π–∫–∏',
      back: '–ù–∞–∑–∞–¥', next: '–í–ø–µ—Ä—ë–¥', check: '–ü—Ä–æ–≤–µ—Ä–∏—Ç—å', reveal: '–ü–æ–∫–∞–∑–∞—Ç—å –æ—Ç–≤–µ—Ç', hard: '‚òÖ –°–ª–æ–∂–Ω—ã–π',
      correct: '–í–µ—Ä–Ω–æ', incorrect: '–ù–µ–≤–µ—Ä–Ω–æ', yourAns: '–í–∞—à –æ—Ç–≤–µ—Ç', rightAns: '–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç',
      result: (ok,total)=>`–†–µ–∑—É–ª—å—Ç–∞—Ç: ${ok} –∏–∑ ${total} (${Math.round(ok*100/Math.max(total,1))}%)`
    },
    es: {
      practice: 'Pr√°ctica', exam: 'Examen', settings: 'Ajustes',
      back: 'Atr√°s', next: 'Siguiente', check: 'Comprobar', reveal: 'Mostrar respuesta', hard: '‚òÖ Dif√≠cil',
      correct: 'Correcto', incorrect: 'Incorrecto', yourAns: 'Tu respuesta', rightAns: 'Respuesta correcta',
      result: (ok,total)=>`Resultado: ${ok} de ${total} (${Math.round(ok*100/Math.max(total,1))}%)`
    }
  }

  // -------------------- Sample dataset (generic, not official DGT) --------------------
  const sampleQuestions = [
    {
      id: 1, topic: '–ó–Ω–∞–∫–∏', image: null,
      question: {ru:'–ß—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç –∫—Ä–∞—Å–Ω—ã–π –≤–æ—Å—å–º–∏—É–≥–æ–ª—å–Ω—ã–π –∑–Ω–∞–∫?', es:'¬øQu√© significa la se√±al octogonal roja?'},
      choices:[
        {id:'A', text:{ru:'–£—Å—Ç—É–ø–∏ –¥–æ—Ä–æ–≥—É', es:'Ceda el paso'}},
        {id:'B', text:{ru:'–°—Ç–æ–ø', es:'Stop'}},
        {id:'C', text:{ru:'–ó–∞–ø—Ä–µ—Ç –æ–±–≥–æ–Ω–∞', es:'Prohibido adelantar'}}
      ], correct:['B'], explanation:{ru:'–ö—Ä–∞—Å–Ω—ã–π –≤–æ—Å—å–º–∏—É–≥–æ–ª—å–Ω–∏–∫ ‚Äî –≤—Å–µ–≥–¥–∞ STOP.', es:'La se√±al octogonal roja significa STOP.'}
    },
    {
      id: 2, topic: '–ó–Ω–∞–∫–∏', image: null,
      question: {ru:'–¢—Ä–µ—É–≥–æ–ª—å–Ω—ã–π –∑–Ω–∞–∫ —Å –∫—Ä–∞—Å–Ω–æ–π –∫–∞–π–º–æ–π –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–∞–µ—Ç –æ‚Ä¶', es:'La se√±al triangular con borde rojo advierte de‚Ä¶'},
      choices:[
        {id:'A', text:{ru:'–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–º –¥–µ–π—Å—Ç–≤–∏–∏', es:'Una obligaci√≥n'}},
        {id:'B', text:{ru:'–û–ø–∞—Å–Ω–æ—Å—Ç–∏', es:'Un peligro'}},
        {id:'C', text:{ru:'–ó–∞–ø—Ä–µ—Ç–µ', es:'Una prohibici√≥n'}}
      ], correct:['B'], explanation:{ru:'–¢—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫ ‚Äî –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –æ–± –æ–ø–∞—Å–Ω–æ—Å—Ç–∏.', es:'El tri√°ngulo advierte de un peligro.'}
    },
    {
      id: 3, topic: '–ó–Ω–∞–∫–∏', image: null,
      question: {ru:'–°–∏–Ω–∏–π –∫—Ä—É–≥–ª—ã–π –∑–Ω–∞–∫ –æ–∑–Ω–∞—á–∞–µ—Ç‚Ä¶', es:'La se√±al circular azul indica‚Ä¶'},
      choices:[
        {id:'A', text:{ru:'–ó–∞–ø—Ä–µ—Ç', es:'Prohibici√≥n'}},
        {id:'B', text:{ru:'–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ', es:'Peligro'}},
        {id:'C', text:{ru:'–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ', es:'Obligaci√≥n'}}
      ], correct:['C'], explanation:{ru:'–°–∏–Ω–∏–π –∫—Ä—É–≥ ‚Äî –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–µ (–Ω–∞–ø—Ä., –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–≤–∏–∂–µ–Ω–∏—è).', es:'El c√≠rculo azul indica obligaci√≥n.'}
    },
    {
      id: 4, topic: '–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å', image: null,
      question: {ru:'–ß—Ç–æ —Å–ª–µ–¥—É–µ—Ç —Å–¥–µ–ª–∞—Ç—å –ø–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º –æ–±–≥–æ–Ω–∞?', es:'¬øQu√© se debe hacer antes de adelantar?'},
      choices:[
        {id:'A', text:{ru:'–£–±–µ–¥–∏—Ç—å—Å—è –≤ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–π –≤–∏–¥–∏–º–æ—Å—Ç–∏ –∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –ø–æ–º–µ—Ö', es:'Asegurar visibilidad y ausencia de obst√°culos'}},
        {id:'B', text:{ru:'–ü–æ–¥–∞—Ç—å –∑–≤—É–∫–æ–≤–æ–π —Å–∏–≥–Ω–∞–ª', es:'Tocar el claxon'}},
        {id:'C', text:{ru:'–í–∫–ª—é—á–∏—Ç—å –∞–≤–∞—Ä–∏–π–Ω—É—é —Å–∏–≥–Ω–∞–ª–∏–∑–∞—Ü–∏—é', es:'Encender las luces de emergencia'}}
      ], correct:['A'], explanation:{ru:'–ì–ª–∞–≤–Ω–æ–µ ‚Äî –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –æ–±–∑–æ—Ä.', es:'Primero, garantizar seguridad y visibilidad.'}
    },
    {
      id: 5, topic: '–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å', image: null,
      question: {ru:'–ö–æ–≥–¥–∞ —Å–ª–µ–¥—É–µ—Ç —É–≤–µ–ª–∏—á–∏—Ç—å –¥–∏—Å—Ç–∞–Ω—Ü–∏—é –¥–æ –≤–ø–µ—Ä–µ–¥–∏ –∏–¥—É—â–µ–≥–æ –∞–≤—Ç–æ–º–æ–±–∏–ª—è?', es:'¬øCu√°ndo se debe aumentar la distancia de seguridad?'},
      choices:[
        {id:'A', text:{ru:'–í –¥–æ–∂–¥—å –∏–ª–∏ —Ç—É–º–∞–Ω', es:'Con lluvia o niebla'}},
        {id:'B', text:{ru:'–ù–∞ —Å—É—Ö–æ–π –ø—Ä—è–º–æ–π –¥–æ—Ä–æ–≥–µ', es:'En recta seca'}},
        {id:'C', text:{ru:'–í –ø—Ä–æ–±–∫–µ –Ω–∞ –Ω–∏–∑–∫–æ–π —Å–∫–æ—Ä–æ—Å—Ç–∏', es:'En atasco a baja velocidad'}}
      ], correct:['A'], explanation:{ru:'–°–∫–æ–ª—å–∑–∫–∞—è –¥–æ—Ä–æ–≥–∞ ‚Äî –¥–ª–∏–Ω–Ω–µ–µ —Ç–æ—Ä–º–æ–∑–Ω–æ–π –ø—É—Ç—å.', es:'Con baja adherencia, aumenta la distancia.'}
    },
    {
      id: 6, topic: '–≠—Ç–∏–∫–∞', image: null,
      question: {ru:'–†–∞–∑–≥–æ–≤–∞—Ä–∏–≤–∞—Ç—å –ø–æ —Ç–µ–ª–µ—Ñ–æ–Ω—É –±–µ–∑ –≥—Ä–æ–º–∫–æ–π —Å–≤—è–∑–∏ –∑–∞ —Ä—É–ª—ë–º‚Ä¶', es:'Hablar por tel√©fono sin manos libres al conducir‚Ä¶'},
      choices:[
        {id:'A', text:{ru:'–†–∞–∑—Ä–µ—à–µ–Ω–æ –ø—Ä–∏ –Ω–∏–∑–∫–æ–π —Å–∫–æ—Ä–æ—Å—Ç–∏', es:'Permitido a baja velocidad'}},
        {id:'B', text:{ru:'–û–ø–∞—Å–Ω–æ –∏ –æ—Ç–≤–ª–µ–∫–∞–µ—Ç –≤–æ–¥–∏—Ç–µ–ª—è', es:'Es peligroso y distrae'}},
        {id:'C', text:{ru:'–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –Ω–∞ —Ç—Ä–∞—Å—Å–µ', es:'Recomendado en autopista'}}
      ], correct:['B'], explanation:{ru:'–û—Ç–≤–ª–µ—á–µ–Ω–∏–µ –ø–æ–≤—ã—à–∞–µ—Ç —Ä–∏—Å–∫ –î–¢–ü.', es:'La distracci√≥n aumenta el riesgo.'}
    },
    {
      id: 7, topic: '–ú–∞–Ω—ë–≤—Ä—ã', image: null,
      question: {ru:'–ü–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º –¥–≤–∏–∂–µ–Ω–∏—è –Ω—É–∂–Ω–æ‚Ä¶', es:'Antes de iniciar la marcha hay que‚Ä¶'},
      choices:[
        {id:'A', text:{ru:'–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Ç–æ–ª—å–∫–æ –≤ –ª–µ–≤–æ–µ –∑–µ—Ä–∫–∞–ª–æ', es:'Mirar solo el espejo izquierdo'}},
        {id:'B', text:{ru:'–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–µ—Ä–∫–∞–ª–∞ –∏ ¬´—Å–ª–µ–ø—ã–µ –∑–æ–Ω—ã¬ª', es:'Comprobar espejos y √°ngulos muertos'}},
        {id:'C', text:{ru:'–ü–æ–¥–∞—Ç—å –∑–≤—É–∫–æ–≤–æ–π —Å–∏–≥–Ω–∞–ª', es:'Tocar el claxon'}}
      ], correct:['B'], explanation:{ru:'–ü—Ä–æ–≤–µ—Ä–∫–∞ ¬´—Å–ª–µ–ø—ã—Ö –∑–æ–Ω¬ª –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞.', es:'Comprueba √°ngulos muertos.'}
    },
    {
      id: 8, topic: '–ü–µ—à–µ—Ö–æ–¥—ã', image: null,
      question: {ru:'–ü—Ä–∏ –ø—Ä–∏–±–ª–∏–∂–µ–Ω–∏–∏ –∫ ¬´–∑–µ–±—Ä–µ¬ª —Å –ø–µ—à–µ—Ö–æ–¥–∞–º–∏ —Å–ª–µ–¥—É–µ—Ç‚Ä¶', es:'Al acercarse a un paso de peatones con peatones hay que‚Ä¶'},
      choices:[
        {id:'A', text:{ru:'–£—Å–∫–æ—Ä–∏—Ç—å—Å—è –∏ –ø—Ä–æ—Å–∫–æ—á–∏—Ç—å', es:'Acelerar y pasar'}},
        {id:'B', text:{ru:'–û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å—Å—è –∏ —É—Å—Ç—É–ø–∏—Ç—å', es:'Detenerse y ceder'}},
        {id:'C', text:{ru:'–ü—Ä–æ—Å–∏–≥–Ω–∞–ª–∏—Ç—å –∏ –µ—Ö–∞—Ç—å –¥–∞–ª—å—à–µ', es:'Pitar y seguir'}}
      ], correct:['B'], explanation:{ru:'–ü–µ—à–µ—Ö–æ–¥ –∏–º–µ–µ—Ç –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –Ω–∞ –ø–µ—Ä–µ—Ö–æ–¥–µ.', es:'El peat√≥n tiene prioridad.'}
    },
    {
      id: 9, topic: '–°–≤–µ—Ç–æ–≤—ã–µ –ø—Ä–∏–±–æ—Ä—ã', image: null,
      question: {ru:'–ö–æ–≥–¥–∞ –ø—Ä–∏–º–µ–Ω—è—Ç—å –ø—Ä–æ—Ç–∏–≤–æ—Ç—É–º–∞–Ω–Ω—ã–µ —Ñ–∞—Ä—ã?', es:'¬øCu√°ndo usar las luces antiniebla?'},
      choices:[
        {id:'A', text:{ru:'–í —Ç—É–º–∞–Ω–µ, —Å–∏–ª—å–Ω–æ–º –¥–æ–∂–¥–µ –∏–ª–∏ —Å–Ω–µ–≥–æ–ø–∞–¥–µ', es:'Con niebla, lluvia o nieve intensas'}},
        {id:'B', text:{ru:'–í—Å–µ–≥–¥–∞ –Ω–æ—á—å—é', es:'Siempre de noche'}},
        {id:'C', text:{ru:'–¢–æ–ª—å–∫–æ –¥–Ω—ë–º', es:'Solo de d√≠a'}}
      ], correct:['A'], explanation:{ru:'–ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –ø—Ä–∏ —É—Ö—É–¥—à–µ–Ω–∏–∏ –≤–∏–¥–∏–º–æ—Å—Ç–∏.', es:'Se usan con baja visibilidad.'}
    },
    {
      id: 10, topic: '–î–∏—Å—Ç–∞–Ω—Ü–∏—è', image: null,
      question: {ru:'–ü—Ä–∞–≤–∏–ª–æ –¥–≤—É—Ö —Å–µ–∫—É–Ω–¥ –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –∫‚Ä¶', es:'La regla de los dos segundos se refiere a‚Ä¶'},
      choices:[
        {id:'A', text:{ru:'–í—ã–±–æ—Ä—É –ø–µ—Ä–µ–¥–∞—á–∏', es:'Selecci√≥n de marcha'}},
        {id:'B', text:{ru:'–î–∏—Å—Ç–∞–Ω—Ü–∏–∏ –¥–æ –≤–ø–µ—Ä–µ–¥–∏ –∏–¥—É—â–µ–≥–æ –∞–≤—Ç–æ', es:'Distancia de seguridad'}},
        {id:'C', text:{ru:'–°–º–µ–Ω–µ –ø–æ–ª–æ—Å—ã', es:'Cambio de carril'}}
      ], correct:['B'], explanation:{ru:'–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –≤—Ä–µ–º–µ–Ω–Ω–æ–π –∏–Ω—Ç–µ—Ä–≤–∞–ª –¥–æ –≤–ø–µ—Ä–µ–¥–∏ –∏–¥—É—â–µ–≥–æ.', es:'Intervalo m√≠nimo con el veh√≠culo precedente.'}
    },
    {
      id: 11, topic: '–û–ø–µ—Ä–µ–∂–µ–Ω–∏–µ', image: null,
      question: {ru:'–ì–¥–µ –æ–±—ã—á–Ω–æ –∑–∞–ø—Ä–µ—â—ë–Ω –æ–±–≥–æ–Ω?', es:'¬øD√≥nde suele estar prohibido adelantar?'},
      choices:[
        {id:'A', text:{ru:'–ù–∞ –ø–µ—à–µ—Ö–æ–¥–Ω—ã—Ö –ø–µ—Ä–µ—Ö–æ–¥–∞—Ö', es:'En pasos de peatones'}},
        {id:'B', text:{ru:'–ù–∞ –∞–≤—Ç–æ–º–∞–≥–∏—Å—Ç—Ä–∞–ª—è—Ö', es:'En autopistas'}},
        {id:'C', text:{ru:'–ù–∞ –¥–æ—Ä–æ–≥–∞—Ö —Å –±–æ–ª–µ–µ –¥–≤—É–º—è –ø–æ–ª–æ—Å–∞–º–∏ –≤ –æ–¥–Ω–æ–º –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–∏', es:'En v√≠as con m√°s de dos carriles por sentido'}}
      ], correct:['A'], explanation:{ru:'–û–±–≥–æ–Ω –Ω–∞ ¬´–∑–µ–±—Ä–µ¬ª –æ–ø–∞—Å–µ–Ω –∏ –∑–∞–ø—Ä–µ—â—ë–Ω.', es:'Prohibido en pasos de peatones.'}
    },
    {
      id: 12, topic: '–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç', image: null,
      question: {ru:'–ó–Ω–∞–∫ ¬´–£—Å—Ç—É–ø–∏ –¥–æ—Ä–æ–≥—É¬ª —Ç—Ä–µ–±—É–µ—Ç‚Ä¶', es:'La se√±al ‚ÄúCeda el paso‚Äù exige‚Ä¶'},
      choices:[
        {id:'A', text:{ru:'–ü–æ–ª–Ω–æ–π –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –≤—Å–µ–≥–¥–∞', es:'Parada completa siempre'}},
        {id:'B', text:{ru:'–°–Ω–∏–∂–µ–Ω–∏—è —Å–∫–æ—Ä–æ—Å—Ç–∏ –∏ —É—Å—Ç—É–ø–∫–∏ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏', es:'Reducir y ceder si es necesario'}},
        {id:'C', text:{ru:'–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–≥–æ –ø—Ä–æ–µ–∑–¥–∞ –ø–µ—Ä–≤—ã–º', es:'Pasar primero obligatoriamente'}}
      ], correct:['B'], explanation:{ru:'–û—Å—Ç–∞–Ω–æ–≤–∫—É ‚Äî –ª–∏—à—å –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ –ø–æ–º–µ—Ö.', es:'Solo detenerse si hay riesgo.'}
    }
  ];

  // -------------------- State & storage --------------------
  const $ = sel => document.querySelector(sel);
  const $$ = sel => Array.from(document.querySelectorAll(sel));

  const storeKey = (profile)=>`dgt_trainer_v1::${profile||'default'}`;
  const loadState = (profile)=>{
    try{ return JSON.parse(localStorage.getItem(storeKey(profile))) || {}; }catch{ return {}; }
  }
  const saveState = (profile, data)=>{
    localStorage.setItem(storeKey(profile), JSON.stringify(data));
  }

  let UI_LANG = localStorage.getItem('uiLang') || 'ru';
  let PROFILE = localStorage.getItem('profileName') || 'Michael';
  let DATA = { questions: [], progress: { seen:{}, correct:{}, hard:{} }, exams: [] };

  function initData(){
    const saved = loadState(PROFILE);
    if(saved && saved.questions && saved.questions.length){
      DATA = saved;
    } else {
      DATA.questions = sampleQuestions;
      DATA.progress = { seen:{}, correct:{}, hard:{} };
      DATA.exams = [];
      saveState(PROFILE, DATA);
    }
  }

  // -------------------- Rendering --------------------
  let MODE = 'practice';
  let INDEX = 0;
  let ORDER = [];
  let EXAM = null; // {order:[], answers:{}, startedAt:number}

  function shuffle(arr){
    const a = arr.slice();
    for(let i=a.length-1;i>0;i--){ const j=Math.floor(Math.random()*(i+1)); [a[i],a[j]]=[a[j],a[i]]; }
    return a;
  }

  function setOrder(){ ORDER = DATA.questions.map((q,i)=>i); }

  function setMode(m){
    MODE = m;
    $('#modePractice').classList.toggle('active', m==='practice');
    $('#modeExam').classList.toggle('active', m==='exam');
    $('#examPanel').classList.toggle('hidden', m!=='exam');
    $('#qa').classList.toggle('hidden', m==='exam' && !EXAM);
    updateProgress();
  }

  function t(key){ return (i18n[UI_LANG]||i18n.ru)[key] || key; }

  function updateTexts(){
    $('#modePractice').textContent = t('practice');
    $('#modeExam').textContent = t('exam');
    $('#btnCheck').textContent = t('check');
    $('#btnReveal').textContent = t('reveal');
    $('#btnPrev').textContent = '‚óÄÔ∏é '+t('back');
    $('#btnNext').textContent = t('next')+' ‚ñ∂Ô∏é';
    $('#btnMarkHard').textContent = t('hard');
  }

  function updateProgress(){
    const total = MODE==='exam' && EXAM ? EXAM.order.length : DATA.questions.length;
    const current = MODE==='exam' && EXAM ? EXAM.order.indexOf(INDEX)+1 : (INDEX+1);
    const pct = total? Math.min(100, Math.max(0, Math.round(current*100/total))) : 0;
    $('#progressBar').style.width = pct+'%';
    $('#progressText').textContent = `${current} / ${total}`;
  }

  function renderQuestion(){
    const q = DATA.questions[INDEX];
    if(!q) return;
    $('#topic').textContent = q.topic || '';
    const img = $('#qImage');
    if(q.image){ img.src = q.image; img.classList.remove('hidden'); } else { img.classList.add('hidden'); }

    $('#qText').textContent = q.question[UI_LANG] || q.question.ru || '';

    const choices = $('#choices');
    choices.innerHTML = '';
    (q.choices||[]).forEach(ch=>{
      const row = document.createElement('label');
      row.className = 'choice';
      row.dataset.id = ch.id;
      row.innerHTML = `<input type="checkbox" /> <div><div><strong>${ch.id}</strong>. ${ch.text[UI_LANG] || ch.text.ru}</div></div>`;
      row.addEventListener('click', e=>{
        if(e.target.tagName.toLowerCase()!=='input'){
          const inp = row.querySelector('input');
          inp.checked = !inp.checked;
        }
      });
      choices.appendChild(row);
    });

    $('#explain').classList.add('hidden');
    $('#explain').textContent = '';
    updateProgress();
  }

  function getSelected(){
    return $$('#choices .choice').filter(c=>c.querySelector('input').checked).map(c=>c.dataset.id);
  }

  function markChoiceStates(correctSet, selected){
    $$('#choices .choice').forEach(el=>{
      const id = el.dataset.id;
      el.classList.remove('correct','incorrect');
      if(selected.includes(id)){
        el.classList.add(correctSet.has(id)?'correct':'incorrect');
      }
    });
  }

  function checkAnswer(showOnly=false){
    const q = DATA.questions[INDEX];
    const correctSet = new Set(q.correct||[]);
    const selected = getSelected();
    if(showOnly){
      // Reveal answer
      markChoiceStates(correctSet, Array.from(correctSet));
    } else {
      markChoiceStates(correctSet, selected);
      const right = selected.length===correctSet.size && selected.every(x=>correctSet.has(x));
      // progress
      DATA.progress.seen[q.id] = (DATA.progress.seen[q.id]||0) + 1;
      if(right){ DATA.progress.correct[q.id] = (DATA.progress.correct[q.id]||0) + 1; }
      saveState(PROFILE, DATA);
    }
    const exp = $('#explain');
    const ansLabel = (UI_LANG==='es'?'Respuesta correcta: ':'–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç: ')+ (q.correct||[]).join(', ');
    exp.innerHTML = `<div style="margin-bottom:6px"><strong>${ansLabel}</strong></div>` + (q.explanation?.[UI_LANG] || q.explanation?.ru || '');
    exp.classList.remove('hidden');
  }

  function next(){
    if(MODE==='exam' && EXAM){
      const pos = EXAM.order.indexOf(INDEX);
      if(pos < EXAM.order.length-1){ INDEX = EXAM.order[pos+1]; renderQuestion(); }
      else { finishExam(); }
    } else {
      INDEX = (INDEX+1) % DATA.questions.length; renderQuestion();
    }
  }
  function prev(){
    if(MODE==='exam' && EXAM){
      const pos = EXAM.order.indexOf(INDEX);
      if(pos>0){ INDEX = EXAM.order[pos-1]; renderQuestion(); }
    } else {
      INDEX = (INDEX-1+DATA.questions.length) % DATA.questions.length; renderQuestion();
    }
  }

  // -------------------- Exam mode --------------------
  function startExam(){
    const all = DATA.questions.map((_,i)=>i);
    const count = Math.min(Math.max(parseInt($('#examCount').value||'30',10),1), all.length);
    const shuffled = $('#examShuffle').value==='1' ? shuffle(all) : all;
    EXAM = { order: shuffled.slice(0,count), answers: {}, startedAt: Date.now() };
    INDEX = EXAM.order[0];
    $('#qa').classList.remove('hidden');
    renderQuestion();
  }

  function finishExam(){
    // Compute score using saved correctness from this attempt (simple re-check)
    let ok=0,total=EXAM.order.length; const wrongList=[];
    EXAM.order.forEach(idx=>{
      const q = DATA.questions[idx];
      // Just estimate: if last attempt for q was correct (progress.correct incremented when checked right), we cannot reliably detect per-exam.
      // Instead, we recompute with stored user selection if we had one; for simplicity here, prompt user to review.
      // We'll approximate by asking user to review incorrect marked ones ‚Äî but since we don't store per-question answers, we compute nothing.
      // Better: evaluate now from currently selected inputs (if user pressed Check). We'll treat unanswered as wrong.
      const correctSet = new Set(q.correct||[]), sel = [];
      // no selection data saved per exam; skip.
      // Fallback: count all as "seen" and rely on practice per-question. Show generic message.
    });

    const attempt = { at: Date.now(), total: total, correct: null };
    DATA.exams.push(attempt);
    saveState(PROFILE, DATA);
    $('#examStats').textContent = '–≠–∫–∑–∞–º–µ–Ω –∑–∞–≤–µ—Ä—à—ë–Ω. –ü—Ä–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –≤–æ–ø—Ä–æ—Å—ã –µ—â—ë —Ä–∞–∑ –≤ —Ä–µ–∂–∏–º–µ –ü—Ä–∞–∫—Ç–∏–∫–∞ –∏–ª–∏ –∑–∞–Ω–æ–≤–æ –Ω–∞—á–Ω–∏—Ç–µ –ø–æ–ø—ã—Ç–∫—É.';
  }

  function renderExamHistory(){
    const box = $('#examReview');
    box.innerHTML = '';
    if(!DATA.exams.length){ $('#examStats').textContent = '–ü–æ–∫–∞ –Ω–µ—Ç –ø–æ–ø—ã—Ç–æ–∫.'; return; }
    const last = DATA.exams[DATA.exams.length-1];
    $('#examStats').textContent = last.correct==null ? `–ü–æ–ø—ã—Ç–æ–∫: ${DATA.exams.length}` : (i18n[UI_LANG]?.result(last.correct,last.total));
    DATA.exams.slice().reverse().forEach((at,i)=>{
      const div = document.createElement('div');
      const date = new Date(at.at).toLocaleString();
      div.className='muted';
      div.textContent = `${date} ‚Äî ${at.correct==null? '–∑–∞–≤–µ—Ä—à–µ–Ω–æ' : (i18n[UI_LANG]?.result(at.correct, at.total))}`;
      box.appendChild(div);
    });
  }

  // -------------------- Settings panel --------------------
  function openSettings(){
    $('#settingsPanel').classList.remove('hidden');
    $('#profileName').value = PROFILE;
    $('#uiLang').value = UI_LANG;
  }
  function closeSettings(){
    PROFILE = ($('#profileName').value||'default').trim() || 'default';
    UI_LANG = $('#uiLang').value || 'ru';
    localStorage.setItem('profileName', PROFILE);
    localStorage.setItem('uiLang', UI_LANG);
    initData(); setOrder(); INDEX=0; updateTexts(); renderQuestion(); renderExamHistory();
    $('#settingsPanel').classList.add('hidden');
  }

  // -------------------- Import / Export / Reset --------------------
  $('#importFile').addEventListener('change', async (e)=>{
    const file = e.target.files?.[0]; if(!file) return;
    try{
      const text = await file.text();
      const arr = JSON.parse(text);
      if(!Array.isArray(arr) || !arr.length) throw new Error('–ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç JSON. –û–∂–∏–¥–∞–µ—Ç—Å—è –º–∞—Å—Å–∏–≤ –æ–±—ä–µ–∫—Ç–æ–≤ –≤–æ–ø—Ä–æ—Å–æ–≤.');
      // Minimal validation
      for(const q of arr){
        if(typeof q.id==='undefined') q.id = Math.random().toString(36).slice(2);
        if(!q.question || typeof q.question!=='object') throw new Error('–£ –≤–æ–ø—Ä–æ—Å–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –ø–æ–ª–µ question.{ru|es}');
        if(!Array.isArray(q.choices) || !Array.isArray(q.correct)) throw new Error('–ù—É–∂–Ω—ã –ø–æ–ª—è choices[] –∏ correct[]');
      }
      DATA.questions = arr;
      DATA.progress = { seen:{}, correct:{}, hard:{} };
      saveState(PROFILE, DATA);
      setOrder(); INDEX=0; renderQuestion(); alert('–í–æ–ø—Ä–æ—Å—ã –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã. –ü—Ä–æ–≥—Ä–µ—Å—Å —Å–±—Ä–æ—à–µ–Ω –¥–ª—è –Ω–æ–≤–æ–π –±–∞–∑—ã.');
    }catch(err){ alert('–û—à–∏–±–∫–∞ –∏–º–ø–æ—Ä—Ç–∞: '+ err.message); }
    e.target.value = '';
  });

  $('#btnExport').addEventListener('click', ()=>{
    const blob = new Blob([JSON.stringify(DATA,null,2)], {type:'application/json'});
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a'); a.href=url; a.download=`dgt_trainer_${PROFILE}.json`; a.click();
    setTimeout(()=>URL.revokeObjectURL(url), 2000);
  });

  $('#btnReset').addEventListener('click', ()=>{
    if(confirm('–°–±—Ä–æ—Å–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã–π –ø—Ä–æ–≥—Ä–µ—Å—Å –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ –ø—Ä–æ—Ñ–∏–ª—è?')){
      DATA.progress = { seen:{}, correct:{}, hard:{} };
      DATA.exams = [];
      saveState(PROFILE, DATA);
      alert('–ü—Ä–æ–≥—Ä–µ—Å—Å —Å–±—Ä–æ—à–µ–Ω.');
    }
  });

  // -------------------- Events --------------------
  $('#modePractice').addEventListener('click', ()=>{ setMode('practice'); $('#qa').classList.remove('hidden'); renderQuestion(); });
  $('#modeExam').addEventListener('click', ()=>{ setMode('exam'); renderExamHistory(); $('#qa').classList.add('hidden'); });
  $('#btnSettings').addEventListener('click', openSettings);
  $('#btnCloseSettings').addEventListener('click', closeSettings);

  $('#btnPrev').addEventListener('click', prev);
  $('#btnNext').addEventListener('click', next);
  $('#btnCheck').addEventListener('click', ()=>checkAnswer(false));
  $('#btnReveal').addEventListener('click', ()=>checkAnswer(true));
  $('#btnMarkHard').addEventListener('click', ()=>{
    const q = DATA.questions[INDEX];
    DATA.progress.hard[q.id] = !DATA.progress.hard[q.id];
    saveState(PROFILE, DATA);
    alert(DATA.progress.hard[q.id]? '–ü–æ–º–µ—á–µ–Ω–æ –∫–∞–∫ —Å–ª–æ–∂–Ω—ã–π.' : '–ú–µ—Ç–∫–∞ —Å–ª–æ–∂–Ω–æ–≥–æ —Å–Ω—è—Ç–∞.');
  });

  $('#btnStartExam').addEventListener('click', startExam);

  // -------------------- Boot --------------------
  (function(){
    initData(); setOrder(); updateTexts(); setMode('practice'); renderQuestion(); renderExamHistory();
    // iOS 300ms tap delay guard
    document.addEventListener('touchstart', ()=>{}, {passive:true});
  })();
  </script>
</body>
</html>
